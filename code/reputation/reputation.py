import MySQLdb

db = MySQLdb.connect(host="localhost",
                     user="root",
                     passwd="root",
                     db="reputation")

THRESHOLD_CONN = 10;
THRESHOLD_SCORE = 3;

def getReputationScore(mac_address):
    # Cursor object to execute the queries
    cur = db.cursor()

    # row[0] -> mac_address
    # row[1] -> connection_attempts
    # row[2] -> reputation_score
    cur.execute("SELECT * FROM reputation WHERE mac_address='"+mac_address+"'")
    if (row[1] < THRESHOLD_CONN):
        # Code for cuckoo analysis
        # {
        #
        # }
    else if (row[1] > THRESHOLD_CONN):
        # Discard file if score is less than threshold minimum score
        if (row[2] < THRESHOLD_SCORE):
            return -1;
        else:
            # Code for cuckoo analysis
            # {
            #
            # }

    # Update number of connection_attempts
    cur.execute("UPDATE reputation SET connection_attempts=connection_attempts+1 WHERE mac_address='"+mac_address+"'")
    db.commit();



    # print all the first cell of all the rows
    # for row in cur.fetchall():
    #     print row[1];

    db.close()



mac_address = '127.0.0.1'
getReputationScore(mac_address)
