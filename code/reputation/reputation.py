import MySQLdb
import json
with open('setting.json') as json_data:
    setting = json.load(json_data)

db = MySQLdb.connect(setting['host'],
                     setting['user'],
                     setting['passwd'],
                     setting['db'])

THRESHOLD_CONN = setting['THRESHOLD_CONN']
THRESHOLD_SCORE = setting['THRESHOLD_SCORE']

class Reputation:
    def getData(self, mac_address):
        cur = db.cursor()
        cur.execute("SELECT * FROM reputation WHERE mac_address='"+mac_address+"'")
        row = cur.fetchone()
        cur.close()
        return row


    def updateConnectionAttempts(self, mac_address, createEntryFlag):
        cur = db.cursor()
        if createEntryFlag:
            cur.execute("INSERT INTO reputation VALUES('"+mac_address+"', 0, 5)")
        else:
            cur.execute("UPDATE reputation SET connection_attempts=connection_attempts+1 WHERE mac_address='"+mac_address+"'")
        db.commit();
        cur.close()


db.close()
